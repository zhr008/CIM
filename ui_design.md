# 设备监控系统界面设计文档

## 1. 系统概述

设备监控系统是一个统一的设备监控平台，支持多种协议的设备连接，包括HSMS、OPC、OPC-UA以及KEPServer。该系统提供设备状态监控、消息通信、日志记录等功能。

## 2. 主界面设计

### 2.1 主窗口布局

```
┌─────────────────────────────────────────────────────────────┐
│  统一设备监控系统 (CIM Monitor)                             │
├─────────────────────────────────────────────────────────────┤
│  设备ID │ 设备名称     │ 协议类型 │ 设备类型 │ IP地址 │ 端口 │启用 │在线状态│ 心跳 │响应时间│连接质量│配置文件 │
│  ┌─────┼─────────────┼─────────┼─────────┼────────┼─────┼─────┼───────┼─────┼───────┼───────┼─────────┤
│  │  1  │ HSMS-Host-01│  HSMS   │  host   │127.0.0.1│5000 │ ✓   │ 在线  │ 12  │  45ms │  良好  │HsmsConf │
│  │  2  │ HSMS-EQP-01 │  HSMS   │  EQP    │127.0.0.1│5001 │ ✓   │ 离线  │  0  │   -   │   -    │HsmsConf │
│  │  3  │ KepServer-Ch1│ OPC     │  EQP    │192.168.1│49320│ ✓   │ 在线  │  8  │  32ms │  优秀  │KepConf  │
└─────────────────────────────────────────────────────────────┘
┌─────────────────────────────────────────────────────────────┐
│ 控制按钮区                                                    │
│ [刷新数据] [启动监控] [停止监控] [重启监控] [清空日志] [连接设备] [断开设备] [测试消息] │
└─────────────────────────────────────────────────────────────┘
┌─────────────────────────────────────────────────────────────┐
│ 日志输出区域                                                  │
│ [设备详细信息和通信日志]                                       │
└─────────────────────────────────────────────────────────────┘
```

### 2.2 界面组件说明

#### 数据表格 (DataGridView)
- **列标题**: 设备ID、设备名称、协议类型、设备类型、IP地址、端口、启用、在线状态、心跳、响应时间、连接质量、配置文件
- **功能**:
  - 启用列使用CheckBox控件
  - 支持双击行查看设备详情
  - 实时更新设备状态

#### 控制按钮组
- **刷新数据**: 重新加载设备配置
- **启动监控**: 启动设备监控功能
- **停止监控**: 停止设备监控功能
- **重启监控**: 重启监控系统
- **清空日志**: 清空日志输出框
- **连接设备**: 连接选中设备
- **断开设备**: 断开选中设备
- **测试消息**: 发送测试消息

#### 日志输出框
- **位置**: 主界面底部
- **功能**: 显示设备通信日志、系统状态信息
- **特性**: 自动滚动、支持搜索

## 3. 子窗口设计

### 3.1 设备详情窗口 (DeviceDetailForm)

```
┌─────────────────────────────────────────────────────────────┐
│  设备详情 - [设备名称]                                      │
├─────────────────────────────────────────────────────────────┤
│ 设备信息面板                                                 │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 设备ID:           [值]                                   │ │
│ │ 设备名称:         [值]                                   │ │
│ │ 协议类型:         [值]                                   │ │
│ │ 设备类型:         [值]                                   │ │
│ │ IP地址:           [值]                                   │ │
│ │ 端口:             [值]                                   │ │
│ │ 启用状态:         [值]                                   │ │
│ │ 在线状态:         [值]                                   │ │
│ │ 心跳计数:         [值]                                   │ │
│ │ 响应时间:         [值]                                   │ │
│ │ 连接质量:         [值]                                   │ │
│ └─────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────┤
│ 设备日志:                                                   │
│ [详细的设备通信日志和状态变化记录]                           │
│ [支持实时更新]                                              │
│ [支持导出功能]                                              │
└─────────────────────────────────────────────────────────────┘
```

## 4. 界面交互流程

### 4.1 主界面操作流程
1. **启动**: 程序启动时自动加载配置文件并显示设备列表
2. **双击行**: 弹出设备详情窗口
3. **点击启用**: 直接切换设备启用状态并保存到配置
4. **控制按钮**: 执行相应监控操作

### 4.2 设备详情窗口交互
1. **打开**: 双击主界面设备行时弹出
2. **实时更新**: 设备状态变化时自动更新显示
3. **日志记录**: 该设备的所有通信日志在此显示
4. **关闭**: 用户手动关闭或主程序退出时关闭

## 5. UI控件属性设置

### 5.1 DataGridView属性
```
- AllowUserToAddRows: false
- AllowUserToDeleteRows: false
- ReadOnly: false
- SelectionMode: FullRowSelect
- MultiSelect: false
- AutoSizeColumnsMode: Fill
```

### 5.2 主窗口属性
```
- Size: 1260x808
- StartPosition: CenterScreen
- FormBorderStyle: FixedSingle
- MaximizeBox: true
- MinimizeBox: true
- Text: "设备监控 - 统一设备监控"
```

### 5.3 设备详情窗口属性
```
- Size: 800x600
- StartPosition: CenterParent
- FormBorderStyle: Sizable
- MaximizeBox: true
- MinimizeBox: true
- Text: "设备详情 - [设备名]"
```

## 6. 视觉设计规范

### 6.1 颜色方案
- **主色调**: 蓝色 (#007ACC) - 用于按钮、标题
- **成功状态**: 绿色 (#28A745) - 在线状态、成功消息
- **警告状态**: 黄色 (#FFC107) - 警告信息
- **错误状态**: 红色 (#DC3545) - 错误信息、离线状态
- **背景色**: 白色 (#FFFFFF) - 主背景
- **边框色**: 灰色 (#CCCCCC) - 分隔线

### 6.2 字体规范
- **标题**: Microsoft Sans Serif, 12pt, Bold
- **正文**: Microsoft Sans Serif, 9pt
- **代码**: Consolas, 9pt

### 6.3 图标规范
- 使用标准Windows图标
- 按钮图标与文字结合
- 状态指示使用颜色编码

## 7. 功能特色

### 7.1 实时监控
- 设备状态实时更新
- 心跳计数自动递增
- 响应时间动态计算

### 7.2 多协议支持
- HSMS协议设备
- OPC协议设备
- OPC-UA协议设备
- KEPServer设备

### 7.3 日志管理
- 分级日志显示
- 实时日志更新
- 日志搜索功能

### 7.4 配置管理
- 配置文件自动加载
- 启用状态实时保存
- 支持多配置文件

## 8. 用户体验优化

### 8.1 响应式设计
- 窗口大小可调整
- 表格列宽自适应
- 字体缩放支持

### 8.2 操作便捷性
- 快捷键支持
- 批量操作功能
- 智能提示信息

### 8.3 错误处理
- 友好的错误提示
- 自动重连机制
- 状态恢复功能